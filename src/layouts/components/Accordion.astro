---
const { titulo, contenido, className = "" } = Astro.props;
---

<div class={`accordion ${className}`} data-accordion>
  <button class="accordion__header" data-accordion-trigger>
    <span class="accordion__title">{titulo}</span>
    <svg class="accordion__icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
      <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
  <div class="accordion__content" data-accordion-content>
    <div class="accordion__text">
      <p>{contenido}</p>
    </div>
  </div>
</div>

<script>
  class AccordionController {
    constructor() {
      this.accordions = document.querySelectorAll('[data-accordion]');
      this.init();
    }
    
    init() {
      this.accordions.forEach(accordion => {
        const trigger = accordion.querySelector('[data-accordion-trigger]');
        const content = accordion.querySelector('[data-accordion-content]');
        const icon = accordion.querySelector('.accordion__icon');
        
        // Set initial state
        content.style.height = '0px';
        content.style.overflow = 'hidden';
        content.style.transition = 'height 0.3s ease';
        icon.style.transition = 'transform 0.3s ease';
        
        trigger.addEventListener('click', () => {
          const isOpen = accordion.classList.contains('accordion--open');
          
          if (isOpen) {
            // Close
            content.style.height = '0px';
            accordion.classList.remove('accordion--open');
            icon.style.transform = 'rotate(0deg)';
          } else {
            // Open
            const scrollHeight = content.scrollHeight;
            content.style.height = scrollHeight + 'px';
            accordion.classList.add('accordion--open');
            icon.style.transform = 'rotate(180deg)';
          }
        });
      });
    }
  }
  
  // Initialize when DOM is loaded
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => new AccordionController());
  } else {
    new AccordionController();
  }
</script>